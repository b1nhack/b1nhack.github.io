<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>b1n.io</title><meta name=keywords content="b1n.io"><meta name=description content="b1n.io"><meta name=author content="b1n"><link rel=canonical href=https://b1n.io/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><link rel=icon href=https://b1n.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://b1n.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://b1n.io/favicon-32x32.png><link rel=apple-touch-icon href=https://b1n.io/apple-touch-icon.png><link rel=mask-icon href=https://b1n.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.109.0"><link rel=alternate type=application/rss+xml href=https://b1n.io/index.xml><link rel=alternate type=application/json href=https://b1n.io/index.json><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="b1n.io"><meta property="og:description" content="b1n.io"><meta property="og:type" content="website"><meta property="og:url" content="https://b1n.io/"><meta property="og:site_name" content="b1n.io"><meta name=twitter:card content="summary"><meta name=twitter:title content="b1n.io"><meta name=twitter:description content="b1n.io"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"b1n.io","url":"https://b1n.io/","description":"b1n.io","thumbnailUrl":"https://b1n.io/favicon.ico","sameAs":["https://infosec.exchange/@b1n","https://github.com/b1nhack","https://gist.github.com/b1nhack/174e14cd7da5de7bd7dd343a9bc5481b","https://gist.github.com/b1nhack/ed48191c3a7d83c18f5177f742ae16db","/index.xml"]}</script></head><body class="list dark" id=top><header class=header><nav class=nav><div class=logo><a href=https://b1n.io/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://b1n.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://b1n.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://b1n.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class="first-entry home-info"><header class=entry-header><h1>b1n.io</h1></header><section class=entry-content><p>I am a cyber security researcher.</p></section><footer class=entry-footer><div class=social-icons><a href=https://infosec.exchange/@b1n target=_blank rel="noopener noreferrer me" title=Mastodon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.58 13.913c-.29 1.469-2.592 3.121-5.238 3.396-1.379.184-2.737.368-4.185.276-2.368-.092-4.237-.551-4.237-.551.0.184.014.459.043.643.308 2.294 2.317 2.478 4.22 2.57 1.922.0 3.633-.46 3.633-.46l.079 1.653s-1.344.734-3.738.918c-1.32.091-2.96-.092-4.869-.551-4.14-1.102-4.853-5.507-4.961-10.005-.034-1.285-.013-2.57-.013-3.58.0-4.589 3-5.966 3-5.966 1.513-.734 4.11-1.01 6.808-1.01h.067c2.699.0 5.296.276 6.81 1.01.0.0 3 1.377 3 5.967.0.0.037 3.304-.419 5.69" stroke="currentcolor"/><path d="M17.832 8.633v5h-1.978V8.78c0-1.023-.43-1.542-1.29-1.542-.95.0-1.427.616-1.427 1.834v2.655H11.17V9.072c0-1.218-.476-1.834-1.427-1.834-.86.0-1.29.52-1.29 1.542v4.852H6.475V8.633c0-1.022.26-1.834.782-2.434.538-.6 1.243-.909 2.118-.909 1.012.0 1.779.39 2.286 1.169l.492.827.493-.827c.507-.78 1.274-1.169 2.286-1.169.875.0 1.58.308 2.118.909.522.6.782 1.412.782 2.434" fill="currentcolor" stroke="none"/></svg></a><a href=https://github.com/b1nhack target=_blank rel="noopener noreferrer me" title=Github><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://gist.github.com/b1nhack/174e14cd7da5de7bd7dd343a9bc5481b target=_blank rel="noopener noreferrer me" title=Email><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 21" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a><a href=https://gist.github.com/b1nhack/ed48191c3a7d83c18f5177f742ae16db target=_blank rel="noopener noreferrer me" title=Matrix><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentcolor"><path d="M.632.55v22.9H2.28V24H0V0h2.28v.55zm7.043 7.26v1.157h.033c.309-.443.683-.784 1.117-1.024.433-.245.936-.365 1.5-.365.54.0 1.033.107 1.481.314.448.208.785.582 1.02 1.108.254-.374.6-.706 1.034-.992.434-.287.95-.43 1.546-.43.453.0.872.056 1.26.167.388.11.716.286.993.53.276.245.489.559.646.951.152.392.23.863.23 1.417v5.728h-2.349V11.52c0-.286-.01-.559-.032-.812a1.755 1.755.0 00-.18-.66 1.106 1.106.0 00-.438-.448c-.194-.11-.457-.166-.785-.166-.332.0-.6.064-.803.189a1.38 1.38.0 00-.48.499 1.946 1.946.0 00-.231.696 5.56 5.56.0 00-.06.785v4.768h-2.35v-4.8c0-.254-.004-.503-.018-.752a2.074 2.074.0 00-.143-.688 1.052 1.052.0 00-.415-.503c-.194-.125-.476-.19-.854-.19-.111.0-.259.024-.439.074-.18.051-.36.143-.53.282-.171.138-.319.337-.439.595-.12.259-.18.6-.18 1.02v4.966H5.46V7.81zm15.693 15.64V.55H21.72V0H24v24h-2.28v-.55z"/></svg></a><a href=/index.xml target=_blank rel="noopener noreferrer me" title=RSS><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div></footer></article><article class=post-entry><header class=entry-header><h2>SharkLoadLibrary</h2></header><section class=entry-content><p>SharkLoadLibrary 是 DarkLoadLibrary 的完整版
在DarkLoadLibrary中的darkloadlibrary.h文件中, 作者定义了一组宏, 用于Control Flags
#define LOAD_LOCAL_FILE 0x00000001 #define LOAD_REMOTE_FILE 0x00000002 #define LOAD_MEMORY 0x00000003 #define NO_LINK 0x00010000 可以看到, 作者早就定义好了LOAD_REMOTE_FILE的宏, 只不过在公开项目时删除了相关功能
我将功能完善了, 开源在github供大家使用: SharkLoadLibrary
以下是项目介绍:
LoadLibrary for Children’s Paradise.
:sailboat: Folk From DarkLoadLibrary and thanks.
Feature New feature: LOAD_REMOTE_FILE
Usage PDARKMODULE DarkModule = DarkLoadLibrary( LOAD_REMOTE_FILE, // control flags "http://xxxx/demo.dll", // remote dll url, if loading from remote NULL, // dll buffer to load from if loading from memory 0, // dll size if loading from memory L"Demo" // dll name if loaded from memory and remote ); Build && Test Environmental requirements libcurl...</p></section><footer class=entry-footer><span title='2022-12-26 01:24:06 -0500 -0500'>December 26, 2022</span>&nbsp;·&nbsp;b1n</footer><a class=entry-link aria-label="post link to SharkLoadLibrary" href=https://b1n.io/posts/sharkloadlibrary/></a></article><article class=post-entry><header class=entry-header><h2>Pwnable.tw Orw</h2></header><section class=entry-content><p>题目提示: Read the flag from /home/orw/flag.
Only open read write syscall are allowed to use.
checksec:
[*] '/home/kkkk/code/orw' Arch: i386-32-little RELRO: Partial RELRO Stack: Canary found NX: NX disabled PIE: No PIE (0x8048000) RWX: Has RWX segments 看一下伪代码:
int __cdecl main(int argc, const char **argv, const char **envp) { orw_seccomp(); printf("Give my your shellcode:"); read(0, &shellcode, 0xC8u); ((void (*)(void))shellcode)(); return 0; } 读取0xc8个字节, 然后转换为函数指针执行
这道题只需要构建一个open read write的shellcode就可以了
可以用pwntools自动完成
from pwn import * context(os="linux", arch="i386", log_level="debug") r = remote("chall....</p></section><footer class=entry-footer><span title='2022-12-25 01:08:22 -0500 -0500'>December 25, 2022</span>&nbsp;·&nbsp;b1n</footer><a class=entry-link aria-label="post link to Pwnable.tw Orw" href=https://b1n.io/posts/pwnable.tw-orw/></a></article><article class=post-entry><header class=entry-header><h2>Pwnable.tw Start</h2></header><section class=entry-content><p>checksec:
[*] '/home/kkkk/code/start' Arch: i386-32-little RELRO: No RELRO Stack: No canary found NX: NX disabled PIE: No PIE (0x8048000) disassem:
Dump of assembler code for function _start: => 0x08048060 &lt;+0>: push esp 0x08048061 &lt;+1>: push 0x804809d 0x08048066 &lt;+6>: xor eax,eax 0x08048068 &lt;+8>: xor ebx,ebx 0x0804806a &lt;+10>: xor ecx,ecx 0x0804806c &lt;+12>: xor edx,edx 0x0804806e &lt;+14>: push 0x3a465443 0x08048073 &lt;+19>: push 0x20656874 0x08048078 &lt;+24>: push 0x20747261 0x0804807d &lt;+29>: push 0x74732073 0x08048082 &lt;+34>: push 0x2774654c 0x08048087 &lt;+39>: mov ecx,esp 0x08048089 &lt;+41>: mov dl,0x14 0x0804808b &lt;+43>: mov bl,0x1 0x0804808d &lt;+45>: mov al,0x4 0x0804808f &lt;+47>: int 0x80 0x08048091 &lt;+49>: xor ebx,ebx 0x08048093 &lt;+51>: mov dl,0x3c 0x08048095 &lt;+53>: mov al,0x3 0x08048097 &lt;+55>: int 0x80 0x08048099 &lt;+57>: add esp,0x14 0x0804809c &lt;+60>: ret End of assembler dump....</p></section><footer class=entry-footer><span title='2022-12-24 04:37:02 -0500 -0500'>December 24, 2022</span>&nbsp;·&nbsp;b1n</footer><a class=entry-link aria-label="post link to Pwnable.tw Start" href=https://b1n.io/posts/pwnable.tw-start/></a></article><article class=post-entry><header class=entry-header><h2>Cpp Shellcode</h2></header><section class=entry-content><p>I made a repository of Windows Shellcode runners: cpp-shellcode.
Here are some introductions:
cpp-shellcode is A repository of Windows Shellcode runners. The applications load and execute Shellcode using various API calls or techniques.
❤️ THANKS @go-shellcode
The available Shellcode runners include:
CreateFiber CreateRemoteThread CreateThread EtwpCreateEtwThread NtQueueApcThreadEx-Local CreateFiber This application leverages the Windows CreateFiber function from the Kernel32.dll to execute shellcode within this application’s process. This is usefull when you want to avoid remote process injection and want to avoid calling CreateThread....</p></section><footer class=entry-footer><span title='2022-12-24 01:32:07 -0500 -0500'>December 24, 2022</span>&nbsp;·&nbsp;b1n</footer><a class=entry-link aria-label="post link to Cpp Shellcode" href=https://b1n.io/posts/cpp-shellcode/></a></article></main><footer class=footer><span>&copy; 2022 <a href=https://b1n.io/>b1n.io</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>