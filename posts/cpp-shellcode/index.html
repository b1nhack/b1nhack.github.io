<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Cpp Shellcode | b1n.io</title><meta name=keywords content="open source"><meta name=description content="I made a repository of Windows Shellcode runners: cpp-shellcode.
Here are some introductions:
cpp-shellcode is A repository of Windows Shellcode runners. The applications load and execute Shellcode using various API calls or techniques.
❤️ THANKS @go-shellcode
The available Shellcode runners include:
CreateFiber CreateRemoteThread CreateThread EtwpCreateEtwThread NtQueueApcThreadEx-Local CreateFiber This application leverages the Windows CreateFiber function from the Kernel32.dll to execute shellcode within this application&rsquo;s process. This is usefull when you want to avoid remote process injection and want to avoid calling CreateThread."><meta name=author content="b1n"><link rel=canonical href=https://b1n.io/posts/cpp-shellcode/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://b1n.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://b1n.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://b1n.io/favicon-32x32.png><link rel=apple-touch-icon href=https://b1n.io/apple-touch-icon.png><link rel=mask-icon href=https://b1n.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.109.0"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Cpp Shellcode"><meta property="og:description" content="I made a repository of Windows Shellcode runners: cpp-shellcode.
Here are some introductions:
cpp-shellcode is A repository of Windows Shellcode runners. The applications load and execute Shellcode using various API calls or techniques.
❤️ THANKS @go-shellcode
The available Shellcode runners include:
CreateFiber CreateRemoteThread CreateThread EtwpCreateEtwThread NtQueueApcThreadEx-Local CreateFiber This application leverages the Windows CreateFiber function from the Kernel32.dll to execute shellcode within this application&rsquo;s process. This is usefull when you want to avoid remote process injection and want to avoid calling CreateThread."><meta property="og:type" content="article"><meta property="og:url" content="https://b1n.io/posts/cpp-shellcode/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-24T01:32:07-05:00"><meta property="article:modified_time" content="2022-12-24T01:32:07-05:00"><meta property="og:site_name" content="b1n.io"><meta name=twitter:card content="summary"><meta name=twitter:title content="Cpp Shellcode"><meta name=twitter:description content="I made a repository of Windows Shellcode runners: cpp-shellcode.
Here are some introductions:
cpp-shellcode is A repository of Windows Shellcode runners. The applications load and execute Shellcode using various API calls or techniques.
❤️ THANKS @go-shellcode
The available Shellcode runners include:
CreateFiber CreateRemoteThread CreateThread EtwpCreateEtwThread NtQueueApcThreadEx-Local CreateFiber This application leverages the Windows CreateFiber function from the Kernel32.dll to execute shellcode within this application&rsquo;s process. This is usefull when you want to avoid remote process injection and want to avoid calling CreateThread."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://b1n.io/posts/"},{"@type":"ListItem","position":2,"name":"Cpp Shellcode","item":"https://b1n.io/posts/cpp-shellcode/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Cpp Shellcode","name":"Cpp Shellcode","description":"I made a repository of Windows Shellcode runners: cpp-shellcode.\nHere are some introductions:\ncpp-shellcode is A repository of Windows Shellcode runners. The applications load and execute Shellcode using various API calls or techniques.\n❤️ THANKS @go-shellcode\nThe available Shellcode runners include:\nCreateFiber CreateRemoteThread CreateThread EtwpCreateEtwThread NtQueueApcThreadEx-Local CreateFiber This application leverages the Windows CreateFiber function from the Kernel32.dll to execute shellcode within this application\u0026rsquo;s process. This is usefull when you want to avoid remote process injection and want to avoid calling CreateThread.","keywords":["open source"],"articleBody":"I made a repository of Windows Shellcode runners: cpp-shellcode.\nHere are some introductions:\ncpp-shellcode is A repository of Windows Shellcode runners. The applications load and execute Shellcode using various API calls or techniques.\n❤️ THANKS @go-shellcode\nThe available Shellcode runners include:\nCreateFiber CreateRemoteThread CreateThread EtwpCreateEtwThread NtQueueApcThreadEx-Local CreateFiber This application leverages the Windows CreateFiber function from the Kernel32.dll to execute shellcode within this application’s process. This is usefull when you want to avoid remote process injection and want to avoid calling CreateThread.\nCreateRemoteThread This application leverages the Windows CreateRemoteThread function from Kernel32.dll to execute shellocde in a remote process. The application requires that the target process to inject into is already running. The program default injecting Explorer.exe\nCreateThread This application leverages the Windows CreateThread function from Kernel32.dll to execute shellcode within this application’s process. This is usefull when you want to avoid remote process injection.\nEtwpCreateEtwThread This application leverages the Windows EtwpCreateEtwThread function from ntdll.dll to execute shellcode within this application’s process. Original work by TheWover. This is usefull when you want to avoid remote process injection.\nNtQueueApcThreadEx-Local This application uses the undocumented NtQueueApcThreadEx to create a “Special User APC” in the current thread of the current process to execute shellcode. Because the shellcode is loaded and executed in the current process, it is “local”. This same technique can be used for a remote process. NOTE: This will only work on Windows 7 or later. Reference APC Series: User APC API.\n","wordCount":"240","inLanguage":"en","datePublished":"2022-12-24T01:32:07-05:00","dateModified":"2022-12-24T01:32:07-05:00","author":{"@type":"Person","name":"b1n"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://b1n.io/posts/cpp-shellcode/"},"publisher":{"@type":"Organization","name":"b1n.io","logo":{"@type":"ImageObject","url":"https://b1n.io/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://b1n.io/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://b1n.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://b1n.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://b1n.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://b1n.io/>Home</a>&nbsp;»&nbsp;<a href=https://b1n.io/posts/>Posts</a></div><h1 class=post-title>Cpp Shellcode</h1><div class=post-meta><span title='2022-12-24 01:32:07 -0500 -0500'>December 24, 2022</span>&nbsp;·&nbsp;b1n</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#createfiber aria-label=CreateFiber>CreateFiber</a></li><li><a href=#createremotethread aria-label=CreateRemoteThread>CreateRemoteThread</a></li><li><a href=#createthread aria-label=CreateThread>CreateThread</a></li><li><a href=#etwpcreateetwthread aria-label=EtwpCreateEtwThread>EtwpCreateEtwThread</a></li><li><a href=#ntqueueapcthreadex-local aria-label=NtQueueApcThreadEx-Local>NtQueueApcThreadEx-Local</a></li></ul></div></details></div><div class=post-content><p>I made a repository of Windows Shellcode runners: <a href=https://github.com/b1nhack/cpp-shellcode>cpp-shellcode</a>.</p><p>Here are some introductions:</p><p><code>cpp-shellcode</code> is A repository of Windows Shellcode runners. The applications load and execute Shellcode using various API calls or techniques.</p><p>❤️ THANKS @<a href=https://github.com/Ne0nd0g/go-shellcode>go-shellcode</a></p><p>The available Shellcode runners include:</p><ol><li><a href=#CreateFiber>CreateFiber</a></li><li><a href=#CreateRemoteThread>CreateRemoteThread</a></li><li><a href=#CreateThread>CreateThread</a></li><li><a href=#EtwpCreateEtwThread>EtwpCreateEtwThread</a></li><li><a href=#NtQueueApcThreadEx-Local>NtQueueApcThreadEx-Local</a></li></ol><h2 id=createfiber>CreateFiber<a hidden class=anchor aria-hidden=true href=#createfiber>#</a></h2><p>This application leverages the Windows <a href=https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-createfiber>CreateFiber</a> function from the <code>Kernel32.dll</code> to execute shellcode within this application&rsquo;s process. This is usefull when you want to avoid remote process injection and want to avoid calling <code>CreateThread</code>.</p><h2 id=createremotethread>CreateRemoteThread<a hidden class=anchor aria-hidden=true href=#createremotethread>#</a></h2><p>This application leverages the Windows CreateRemoteThread function from Kernel32.dll to execute shellocde in a remote process. The application requires that the target process to inject into is already running. The program default injecting <code>Explorer.exe</code></p><h2 id=createthread>CreateThread<a hidden class=anchor aria-hidden=true href=#createthread>#</a></h2><p>This application leverages the Windows CreateThread function from Kernel32.dll to execute shellcode within this application&rsquo;s process. This is usefull when you want to avoid remote process injection.</p><h2 id=etwpcreateetwthread>EtwpCreateEtwThread<a hidden class=anchor aria-hidden=true href=#etwpcreateetwthread>#</a></h2><p>This application leverages the Windows EtwpCreateEtwThread function from ntdll.dll to execute shellcode within this application&rsquo;s process. Original work by TheWover. This is usefull when you want to avoid remote process injection.</p><h2 id=ntqueueapcthreadex-local>NtQueueApcThreadEx-Local<a hidden class=anchor aria-hidden=true href=#ntqueueapcthreadex-local>#</a></h2><p>This application uses the undocumented <a href=https://docs.rs/ntapi/0.3.1/ntapi/ntpsapi/fn.NtQueueApcThreadEx.html>NtQueueApcThreadEx</a> to create a &ldquo;Special User APC&rdquo; in the current thread of the current process to execute shellcode. Because the shellcode is loaded and executed in the current process, it is &ldquo;local&rdquo;. This same technique can be used for a remote process. <em>NOTE:</em> This will only work on Windows 7 or later. Reference <a href=https://repnz.github.io/posts/apc/user-apc/>APC Series: User APC API</a>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://b1n.io/tags/open-source/>open source</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://b1n.io/>b1n.io</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>