<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | b1n.io</title><meta name=keywords content><meta name=description content="Posts - b1n.io"><meta name=author content="b1n"><link rel=canonical href=https://b1n.io/posts/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><link rel=icon href=https://b1n.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://b1n.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://b1n.io/favicon-32x32.png><link rel=apple-touch-icon href=https://b1n.io/apple-touch-icon.png><link rel=mask-icon href=https://b1n.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.109.0"><link rel=alternate type=application/rss+xml href=https://b1n.io/posts/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Posts"><meta property="og:description" content="b1n.io"><meta property="og:type" content="website"><meta property="og:url" content="https://b1n.io/posts/"><meta property="og:site_name" content="b1n.io"><meta name=twitter:card content="summary"><meta name=twitter:title content="Posts"><meta name=twitter:description content="b1n.io"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://b1n.io/posts/"}]}</script></head><body class="list dark" id=top><header class=header><nav class=nav><div class=logo><a href=https://b1n.io/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://b1n.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://b1n.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://b1n.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://b1n.io/>Home</a></div><h1>Posts</h1></header><article class=post-entry><header class=entry-header><h2>Pwnable.tw Orw</h2></header><section class=entry-content><p>题目提示: Read the flag from /home/orw/flag.
Only open read write syscall are allowed to use.
checksec:
[*] '/home/kkkk/code/orw' Arch: i386-32-little RELRO: Partial RELRO Stack: Canary found NX: NX disabled PIE: No PIE (0x8048000) RWX: Has RWX segments 看一下伪代码:
int __cdecl main(int argc, const char **argv, const char **envp) { orw_seccomp(); printf("Give my your shellcode:"); read(0, &shellcode, 0xC8u); ((void (*)(void))shellcode)(); return 0; } 读取0xc8个字节, 然后转换为函数指针执行
这道题只需要构建一个open read write的shellcode就可以了
可以用pwntools自动完成
from pwn import * context(os="linux", arch="i386", log_level="debug") r = remote("chall....</p></section><footer class=entry-footer><span title='2022-12-25 01:08:22 -0500 -0500'>December 25, 2022</span>&nbsp;·&nbsp;b1n</footer><a class=entry-link aria-label="post link to Pwnable.tw Orw" href=https://b1n.io/posts/pwnable.tw-orw/></a></article><article class=post-entry><header class=entry-header><h2>Pwnable.tw Start</h2></header><section class=entry-content><p>checksec:
[*] '/home/kkkk/code/start' Arch: i386-32-little RELRO: No RELRO Stack: No canary found NX: NX disabled PIE: No PIE (0x8048000) disassem:
Dump of assembler code for function _start: => 0x08048060 &lt;+0>: push esp 0x08048061 &lt;+1>: push 0x804809d 0x08048066 &lt;+6>: xor eax,eax 0x08048068 &lt;+8>: xor ebx,ebx 0x0804806a &lt;+10>: xor ecx,ecx 0x0804806c &lt;+12>: xor edx,edx 0x0804806e &lt;+14>: push 0x3a465443 0x08048073 &lt;+19>: push 0x20656874 0x08048078 &lt;+24>: push 0x20747261 0x0804807d &lt;+29>: push 0x74732073 0x08048082 &lt;+34>: push 0x2774654c 0x08048087 &lt;+39>: mov ecx,esp 0x08048089 &lt;+41>: mov dl,0x14 0x0804808b &lt;+43>: mov bl,0x1 0x0804808d &lt;+45>: mov al,0x4 0x0804808f &lt;+47>: int 0x80 0x08048091 &lt;+49>: xor ebx,ebx 0x08048093 &lt;+51>: mov dl,0x3c 0x08048095 &lt;+53>: mov al,0x3 0x08048097 &lt;+55>: int 0x80 0x08048099 &lt;+57>: add esp,0x14 0x0804809c &lt;+60>: ret End of assembler dump....</p></section><footer class=entry-footer><span title='2022-12-24 04:37:02 -0500 -0500'>December 24, 2022</span>&nbsp;·&nbsp;b1n</footer><a class=entry-link aria-label="post link to Pwnable.tw Start" href=https://b1n.io/posts/pwnable.tw-start/></a></article><article class=post-entry><header class=entry-header><h2>Cpp Shellcode</h2></header><section class=entry-content><p>I made a repository of Windows Shellcode runners: cpp-shellcode.
Here are some introductions:
cpp-shellcode is A repository of Windows Shellcode runners. The applications load and execute Shellcode using various API calls or techniques.
❤️ THANKS @go-shellcode
The available Shellcode runners include:
CreateFiber CreateRemoteThread CreateThread EtwpCreateEtwThread NtQueueApcThreadEx-Local CreateFiber This application leverages the Windows CreateFiber function from the Kernel32.dll to execute shellcode within this application’s process. This is usefull when you want to avoid remote process injection and want to avoid calling CreateThread....</p></section><footer class=entry-footer><span title='2022-12-24 01:32:07 -0500 -0500'>December 24, 2022</span>&nbsp;·&nbsp;b1n</footer><a class=entry-link aria-label="post link to Cpp Shellcode" href=https://b1n.io/posts/cpp-shellcode/></a></article></main><footer class=footer><span>&copy; 2022 <a href=https://b1n.io/>b1n.io</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>